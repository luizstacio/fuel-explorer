fragment ContractFragment on Contract {
  id
  bytecode
  salt
}

fragment StatusFragment on TransactionStatus {
  type: __typename
  ... on SubmittedStatus {
    time
  }
  ... on SuccessStatus {
    block {
      ...BlockIdFragment
    }
    time
    programState {
      returnType
      data
    }
  }
  ... on FailureStatus {
    block {
      ...BlockIdFragment
    }
    time
    reason
    programState {
      returnType
      data
    }
  }
}

fragment OutputsFragment on Output {
  type: __typename
  ... on ChangeOutput {
    amount
    assetId
    to
  }
  ... on CoinOutput {
    amount
    assetId
    to
  }
  ... on ContractCreated {
    contract {
      ...ContractFragment
    }
    stateRoot
  }
  ... on ContractOutput {
    balanceRoot
    inputIndex
    stateRoot
  }
  ... on MessageOutput {
    amount
    recipient
  }
  ... on VariableOutput {
    amount
    assetId
    to
  }
}

fragment InputsFragment on Input {
  type: __typename
  ... on InputCoin {
    amount
    assetId
    maturity
    owner
    txPointer
    utxoId
    witnessIndex
    predicate
    predicateData
  }
  ... on InputContract {
    balanceRoot
    contract {
      id
      salt
      bytecode
    }
    stateRoot
    txPointer
    utxoId
  }
  ... on InputMessage {
    amount
    data
    messageId
    nonce
    recipient
    sender
    witnessIndex
    predicate
    predicateData
  }
}

fragment ReceiptFragment on Receipt {
  contract {
    ...ContractFragment
  }
  pc
  is
  to {
    ...ContractFragment
  }
  toAddress
  amount
  assetId
  gas
  param1
  param2
  val
  ptr
  digest
  reason
  ra
  rb
  rc
  rd
  len
  receiptType
  rawPayload
  result
  gasUsed
  data
  messageId
  sender
  recipient
  nonce
  contractId
}

fragment TransactionFragment on Transaction {
  id
  inputAssetIds
  inputContracts {
    ...ContractFragment
  }
  gasPrice
  gasLimit
  maturity
  txPointer
  isScript
  isCreate
  isMint
  inputs {
    ...InputsFragment
  }
  outputs {
    ...OutputsFragment
  }
  witnesses
  receiptsRoot
  status {
    ...StatusFragment
  }
  receipts {
    ...ReceiptFragment
  }
  script
  scriptData
  bytecodeWitnessIndex
  bytecodeLength
  salt
  storageSlots
  rawPayload
}

fragment BlockIdFragment on Block {
  id
}

fragment BlockFragment on Block {
  id
  header {
    id
    daHeight
    transactionsCount
    outputMessagesCount
    transactionsRoot
    outputMessagesRoot
    height
    prevRoot
    time
    applicationHash
  }
  consensus {
    __typename
    ... on Genesis {
      chainConfigHash
      coinsRoot
      contractsRoot
      messagesRoot
    }
    ... on PoAConsensus {
      signature
    }
  }
  transactions {
    ...TransactionFragment
  }
}

query ($height: U64) {
  block(height: $height) {
    ...BlockFragment
  }
}
